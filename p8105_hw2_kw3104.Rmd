---
title: "p8105_hw2_kw3104"
output: github_document
---

```{r setup}
library(tidyverse)
library(readxl)
```

## Problem 1
Read and clean the data; retain line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance. Convert the entry variable from character (YES vs NO) to a logical variable (the ifelse or case_match function may be useful).

```{r}
stations_data = 
  read_csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv", 
  col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>% 
  janitor::clean_names() %>% 
  select(
    line, station_name, station_latitude, station_longitude, 
    starts_with("route"), entry, exit_only, vending, entrance_type, 
    ada) %>% 
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```
* This data is not tidy. To tidy up the data, I first load the NYC_Transit_Subway_Entrance_And_Exit_Data.csv file. I specify that `Route` columns 8-11 should be character for consistency with 1-7.  This dataset contain varibles like: division, Line, Station_name, Station_latitude, Station_longitude, Route1 to Route 11, Entrance_type, Entry, Exit Only, Vending, staffing, staff_hours, ADA, ADA_notes, Free_crossover, north_south_street, east_west_street, corner, entry_latitude, entrance_longitude, station_location and entrance_loctaion. Then I use `janitor` and `select` to chose those columns that I am interested. Also convert the entry variable from character `yes` vs `no` to logical variable `true` and `false`. There are 1868 rows and 20 columns of the resulting dataset. 


```{r}
stations_data %>%  
  select(station_name, line) %>%  
  distinct()
```
* There are 465 distinct stations.

```{r}
stations_data %>%  
  filter(ada == TRUE) %>%  
  select(station_name, line) %>%  
  distinct()
```
* There are 84 stations are ADA compliant.

```{r}
stations_data %>%  
  filter(vending == "NO") %>% 
  pull(entry) %>%  
  mean()
```
* There is 0.3770492 of station entrances / exits without vening allow entrance.

```{r}
stations_data %>%  
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A") %>%  
  select(station_name, line) %>% 
  distinct()

stations_data %>%  
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>%  
  filter(route == "A", ada == TRUE) %>% 
  select(station_name, line) %>%  
  distinct()
```
* There are 60 distinct stations serve the A train.
* Of the stations that serve the A train, 17 are ADA compliant. 


## Problem 2
Read and clean the Mr. Trash Wheel sheet:

specify the sheet in the Excel file and to omit non-data entries (rows with notes / figures; columns containing notes) using arguments in read_excel
use reasonable variable names
omit rows that do not include dumpster-specific data
round the number of sports balls to the nearest integer and converts the result to an integer variable (using `as.integer`)

```{r}
# Load libraries
library(readxl)
library(dplyr)

# Correct file path
Trash_data <- "./data/202409 Trash Wheel Collection Data.xlsx"  
```

```{r}
Mr_Trash_Wheel = 
  read_excel(Trash_data, sheet = "Mr. Trash Wheel", range = "A2:N653") |> 
  janitor::clean_names() |>
  mutate(
    sports_balls = as.integer(round(sports_balls)),
    year = as.double(year),
    Trash_Wheel = "Mr"
  )

Prof_Trash_Wheel = 
  read_excel(Trash_data, sheet = "Professor Trash Wheel", range = "A2:M120") |>
  janitor::clean_names() |>
  mutate(
    Trash_Wheel = "Prof"
    )

Gwynnda_Trash_Wheel = 
  read_excel(Trash_data, sheet = "Gwynnda Trash Wheel", range="A2:L265") |>
  janitor::clean_names() |>
  mutate(
    Trash_Wheel = "Gwynnda"
    )

combined_q2=bind_rows(Mr_Trash_Wheel,Prof_Trash_Wheel,Gwynnda_Trash_Wheel)
```

The data set `Mr. Trash Wheel` has 651 observations and 15 variables, the data set `Professor Trash Wheel` has 118 observations and 14 variables, the data set `Gwynnda Trash Wheel` has 263 observations and 13 variables.

The merged data of these three data sets has 1032 observations and 15 variables. The merged data contains variable `dumpster` which indicates the no. of dumpster and variables `year`, `month` and `date` which indicate the date, then `weight_tons` and viriables of different litter type show the amount of total litter and amount of each litter type. 

The total weight of trash collected by Professor Trash Wheel is: `r sum(combined_q2$weight_tons[combined_q2$Trash_Wheel=="Prof"])`, the total number of cigarette butts collected by Gwynnda in June of 2022 is: `r sum(combined_q2$cigarette_butts[combined_q2$Trash_Wheel=="Gwynnda" & combined_q2$year=="2022" & combined_q2$month=="June"])`.

```{r}

```


